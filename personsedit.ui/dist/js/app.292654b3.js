(function(e){function t(t){for(var r,a,i=t[0],l=t[1],c=t[2],d=0,p=[];d<i.length;d++)a=i[d],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&p.push(o[a][0]),o[a]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);u&&u(t);while(p.length)p.shift()();return s.push.apply(s,c||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],r=!0,i=1;i<n.length;i++){var l=n[i];0!==o[l]&&(r=!1)}r&&(s.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},o={app:0},s=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var u=l;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),o=(n("54ba"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",{attrs:{id:"app"}},[n("v-app-bar",{attrs:{app:"",color:"indigo",dark:""}},[n("v-toolbar-title",[e._v("Добро пожаловать, "+e._s(e.Username)+"!")]),n("v-spacer"),n("v-dialog",{attrs:{"max-width":"500px"},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on,o=t.attrs;return[n("v-btn",e._g(e._b({staticClass:"ma-10",on:{click:e.ShowCreateModal}},"v-btn",o,!1),r),[n("v-icon",[e._v("mdi-plus")]),e._v("1 пользователь ")],1)]}}]),model:{value:e.showDialog,callback:function(t){e.showDialog=t},expression:"showDialog"}},[n("v-form",{model:{value:e.validPerson,callback:function(t){e.validPerson=t},expression:"validPerson"}},[n("v-card",[n("v-card-text",[n("v-container",[n("v-text-field",{attrs:{label:"Имя пользователя",counter:25,rules:e.nameRules,required:""},model:{value:e.editedPerson.person.name,callback:function(t){e.$set(e.editedPerson.person,"name",t)},expression:"editedPerson.person.name"}}),n("v-text-field",{attrs:{label:"Email",rules:e.emailRules},model:{value:e.editedPerson.person.email,callback:function(t){e.$set(e.editedPerson.person,"email",t)},expression:"editedPerson.person.email"}}),n("v-text-field",{attrs:{label:"Логин",disabled:!e.isCreateModal,rules:e.loginRules,required:""},model:{value:e.editedPerson.person.login,callback:function(t){e.$set(e.editedPerson.person,"login",t)},expression:"editedPerson.person.login"}}),n("v-text-field",{attrs:{label:"Пароль",rules:e.passwordRules,required:""},model:{value:e.editedPerson.person.password,callback:function(t){e.$set(e.editedPerson.person,"password",t)},expression:"editedPerson.person.password"}}),n("v-select",{attrs:{multiple:"",label:"Роли",items:e.roles,"item-text":"name","return-object":""},model:{value:e.editedPerson.roles,callback:function(t){e.$set(e.editedPerson,"roles",t)},expression:"editedPerson.roles"}})],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.CloseModal}},[e._v("Cancel")]),n("v-btn",{attrs:{color:"blue darken-1",text:"",disabled:!e.validPerson},on:{click:function(t){return e.EditOrCreatePerson(e.editedPerson)}}},[e._v("Save")])],1)],1)],1)],1),n("v-dialog",{attrs:{fullscreen:"","hide-overlay":"",transition:""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on,o=t.attrs;return[n("v-icon",e._g(e._b({attrs:{large:""},on:{click:e.ExitAccount}},"v-icon",o,!1),r),[e._v("mdi-exit-to-app")])]}}]),model:{value:e.authDialog,callback:function(t){e.authDialog=t},expression:"authDialog"}},[n("v-card",[n("v-container",{staticClass:"fill-height",attrs:{fluid:""}},[n("v-row",{attrs:{align:"center",justify:"center"}},[n("v-col",{attrs:{cols:"12",sm:"8",md:"4"}},[n("v-card",{staticClass:"elevation-12"},[n("v-toolbar",{attrs:{color:"primary",dark:"",flat:""}},[n("v-toolbar-title",[e._v("Авторизация")])],1),n("v-card-text",[n("v-form",[n("v-text-field",{attrs:{label:"Логин","prepend-icon":"mdi-account",type:"text"},model:{value:e.authProperties.login,callback:function(t){e.$set(e.authProperties,"login",t)},expression:"authProperties.login"}}),n("v-text-field",{attrs:{label:"Пароль","prepend-icon":"mdi-lock",type:"password"},model:{value:e.authProperties.password,callback:function(t){e.$set(e.authProperties,"password",t)},expression:"authProperties.password"}})],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"primary"},on:{click:e.AuthPerson}},[e._v("Вход")])],1)],1)],1)],1)],1)],1)],1)],1),n("v-main",[n("v-container",{attrs:{fluid:""}},[e.persons.length>0?n("v-simple-table",{attrs:{height:"500px","fixed-header":Boolean(!0)}},[n("thead",[n("tr",[n("th",[e._v("Имя")]),n("th",[e._v("Логин")]),n("th",[e._v("Роли")]),n("th",[e._v("Действия")])])]),n("tbody",e._l(e.persons,(function(t){return n("tr",{key:t.id},[n("td",[e._v(e._s(t.person.name))]),n("td",[e._v(e._s(t.person.login))]),n("td",[e._v(e._s(t.roles.map((function(e){return e.name})).toString()))]),n("td",[n("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(n){return e.ShowEditModal(t)}}},[e._v("mdi-pencil")]),n("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(n){return e.DeletePerson(t)}}},[e._v("mdi-delete")])],1)])})),0)]):e._e()],1)],1)],1)}),s=[],a=(n("c975"),n("a434"),n("b0c0"),{name:"App",data:function(){return{isCreateModal:!0,editPersonIndex:-1,editedPerson:{person:{},roles:[]},authProperties:{login:"",pasword:""},roles:[],authDialog:!0,showDialog:!1,persons:[],userName:"",emailRules:[function(e){return!!e||""},function(e){return/.+@.+\..+/.test(e)||"Неверный email адрес"}],nameRules:[function(e){return!!e||"Имя обязательно"},function(e){return e&&e.length<=25||"Имя должно иметь до 25 символов"}],loginRules:[function(e){return!!e||"Login обязателен"}],passwordRules:[function(e){return!!e||"Password обязателен"}],validPerson:!1}},computed:{Username:function(){return this.userName}},methods:{GetPersons:function(){var e=this;this.$store.dispatch("GetPersons").then((function(t){return e.persons=t}))},EditOrCreatePerson:function(e){var t=this;this.$store.dispatch("EditOrCreatePerson",e).then((function(n){t.showDialog=!1,t.editedPerson={person:{},roles:[]},t.editPersonIndex=-1,""!=n.data?t.persons.push(n.data):t.persons.splice(t.editPersonIndex,1,e)}))},DeletePerson:function(e){var t=this,n=this.persons.indexOf(e);confirm("Вы уверены, что хотите удалить эту запись?")&&this.$store.dispatch("DeletePerson",e.person.id).then((function(){return t.persons.splice(n,1)}))},CloseModal:function(){this.editedPerson={person:{},roles:[]},this.showDialog=!1},ShowEditModal:function(e){var t=this;this.isCreateModal=!1,this.$store.dispatch("GetRoles").then((function(e){return t.roles=e})),this.editPersonIndex=this.persons.indexOf(e),this.editedPerson=Object.assign({},JSON.parse(JSON.stringify(e))),this.showDialog=!0},ShowCreateModal:function(){var e=this;this.isCreateModal=!0,this.$store.dispatch("GetRoles").then((function(t){return e.roles=t}))},ExitAccount:function(){this.authDialog=!0,this.persons=[]},AuthPerson:function(){var e=this;this.$store.dispatch("AuthPerson",this.authProperties).then((function(t){200===t.status&&(e.userName=t.data.name,e.authDialog=!1,e.GetPersons())}))}}}),i=a,l=n("2877"),c=Object(l["a"])(i,o,s,!1,null,null,null),u=c.exports,d=(n("5363"),n("ce5b")),p=n.n(d);n("bf40");r["default"].use(p.a);var f={icons:{iconfont:"mdi"}},h=new p.a(f),v=n("2f62"),m=(n("d3b7"),n("bc3a")),P=n.n(m),b="",g={AuthPerson:function(e,t){e.dispatch;return new Promise((function(e,n){P.a.post(appConfig.ApiUrl+"Account",{login:t.login,password:t.password}).then((function(t){b=t.data.access_token,e(t)})).catch((function(e){return n(alert(e))}))}))},GetPersons:function(){return new Promise((function(e,t){P.a.get(appConfig.ApiUrl+"Persons",{headers:{Authorization:"Bearer "+b}}).then((function(t){return e(t.data)})).catch((function(e){return t(alert(e))}))}))},DeletePerson:function(e,t){e.dispatch;return new Promise((function(e,n){P.a.delete(appConfig.ApiUrl+"Persons",{headers:{Authorization:"Bearer "+b},params:{personId:t}}).then((function(t){return e(t)})).catch((function(e){return n(alert(e))}))}))},EditOrCreatePerson:function(e,t){e.dispatch;return new Promise((function(e,n){P.a.post(appConfig.ApiUrl+"Persons",{Person:t.person,Roles:Object.assign({},t).roles},{headers:{Authorization:"Bearer "+b}}).then((function(t){return e(t)})).catch((function(e){return n(alert(e))}))}))},GetRoles:function(){return new Promise((function(e,t){P.a.get(appConfig.ApiUrl+"Roles",{headers:{Authorization:"Bearer "+b}}).then((function(t){return e(t.data)})).catch((function(e){return t(alert(e))}))}))}},w={},x={},_={};r["default"].use(v["a"]);var k=new v["a"].Store({actions:g,getters:w,mutations:x,state:_}),y=k;new r["default"]({vuetify:h,store:y,render:function(e){return e(u)}}).$mount("#app")}});
//# sourceMappingURL=app.292654b3.js.map